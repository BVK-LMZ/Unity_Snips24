using UnityEngine;

public class TankMovement : MonoBehaviour
{
    // Tank settings
    [Header("Tank Settings")]
    [SerializeField] private float tankMoveSpeed = 5f;
    [SerializeField] private float tankRotateSpeed = 180f;

    // Tank components
    [Header("Tank Components")]
    [SerializeField] private Rigidbody rbTank;
    [SerializeField] private BoxCollider bcTank;

    // Tank input
    private float horizontalInput;
    private float verticalInput;

    /// <summary>
    /// CORE FUNCTIONS
    /// </summary>

    // Initialize and check tank components
    private void InitializeComponents()
    {
        rbTank = GetComponent<Rigidbody>();
        bcTank = GetComponent<BoxCollider>();

        if (rbTank == null)
        {
            Debug.LogError("Rigidbody component is missing!");
        }

        if (bcTank == null)
        {
            Debug.LogError("BoxCollider component is missing!");
        }
    }

    // Handle tank movement based on input
    private void HandleMovementInput()
    {
        horizontalInput = Input.GetAxis("Horizontal");
        verticalInput = Input.GetAxis("Vertical");


        // Calculate movement amount based on input and movement speed



        float verticalMovementAmount = verticalInput * tankMoveSpeed * Time.deltaTime;
        float horizontalMovementAmount = horizontalInput * tankMoveSpeed * Time.deltaTime;

        // Calculate combined movement vector
        Vector3 movement = (transform.forward * verticalMovementAmount) + (transform.right * horizontalMovementAmount);


        // Apply movement to the tank
        rbTank.MovePosition(rbTank.position + movement);


    }

    // Handle tank rotation based on key input
    private void HandleRotationInput()
    {
        float rotationDirection = 0f;

        // Get rotation input
        if (Input.GetKey(KeyCode.Q))
        {
            rotationDirection = -1f; // Rotate left
        }
        else if (Input.GetKey(KeyCode.E))
        {
            rotationDirection = 1f; // Rotate right
        }

        // Calculate rotation amount based on input and rotation speed
        float rotationAmount = rotationDirection * tankRotateSpeed * Time.deltaTime;

        // Apply rotation to the tank
        transform.Rotate(Vector3.up, rotationAmount);
    }

    /// <summary>
    /// MONOBEHAVIOUR FUNCTIONS
    /// </summary>

    // Start is called before the first frame update
    private void Start()
    {
        InitializeComponents();
    }

    // Update is called once per frame
    private void Update()
    {
        HandleMovementInput();
        HandleRotationInput();
    }
}
